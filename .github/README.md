# GitHub Actions CI/CD Pipeline

This repository includes comprehensive GitHub Actions workflows for automated testing, building, and releasing the Discogs Swift Package.

## ðŸš€ Workflows Overview

### 1. **CI Workflow** (`.github/workflows/ci.yml`)

Automatically runs on every push and pull request to `main` and `develop` branches.

#### Jobs Included:

- **ðŸ”¨ Build & Test**: Cross-platform building and unit testing (macOS & Ubuntu)
- **ðŸ“¦ SPM Validation**: Swift Package Manager validation and dependency checks
- **ðŸ” Code Quality**: Build analysis and optional SwiftLint checking
- **ðŸ“± Platform Tests**: Multi-platform compatibility testing (iOS, macOS, tvOS, watchOS)
- **ðŸ§ª Integration Tests**: Mock integration tests and enhanced compliance tests
- **ðŸŒ Live API Tests**: Optional live API testing (main branch only)
- **ðŸ“š Documentation**: Documentation build verification
- **ðŸ“ Examples**: Example code compilation verification
- **âš™ï¸ Scripts**: Test script validation
- **ðŸ” Security**: Security audit and sensitive information checks
- **âœ… Release Check**: Release readiness validation (main branch only)
- **ðŸ“Š Summary**: Comprehensive pipeline summary

### 2. **Release Workflow** (`.github/workflows/release.yml`)

Triggered when creating version tags (e.g., `v1.0.0`) or manually via workflow dispatch.

#### Jobs Included:

- **âœ… Pre-Release Validation**: Version format validation and full test suite
- **ðŸ”¨ Build Release**: Cross-platform release builds
- **ðŸ“š Generate Docs**: Documentation generation
- **ðŸ” Security Audit**: Dependency security audit
- **ðŸš€ Create Release**: GitHub release creation with artifacts
- **ðŸ“‹ Post-Release**: Post-release tasks and notifications

## ðŸŽ¯ Setting Up CI/CD

### Required Repository Secrets

For live API testing, add this secret to your GitHub repository:

1. Go to your repository settings â†’ Secrets and variables â†’ Actions
2. Add a new repository secret:
   - **Name**: `DISCOGS_API_TOKEN`
   - **Value**: Your Discogs API personal access token

> **Note**: Live API tests only run on the `main` branch to avoid excessive API usage.

### Triggering Workflows

#### CI Workflow
- **Automatic**: Runs on every push/PR to `main` or `develop`
- **Manual**: Can be triggered via GitHub Actions tab

#### Release Workflow
- **Tag-based**: Create a tag like `v1.0.0` and push it
  ```bash
  git tag v1.0.0
  git push origin v1.0.0
  ```
- **Manual**: Use workflow dispatch in GitHub Actions tab

## ðŸ“Š Workflow Features

### Cross-Platform Support
- **macOS**: Native Swift development environment
- **Ubuntu**: Linux compatibility testing
- **iOS/tvOS/watchOS**: Simulator-based testing

### Test Categories
- **Unit Tests**: Fast, isolated component tests
- **Integration Tests**: Service interaction tests with mocks
- **Live API Tests**: Real API integration validation
- **Platform Tests**: Multi-platform compatibility verification

### Quality Assurance
- **Build Validation**: Ensures clean compilation across platforms
- **Security Auditing**: Dependency vulnerability checks
- **Code Quality**: Optional linting and analysis
- **Documentation**: Verifies documentation can be generated

### Smart Test Execution
- **Parallel Testing**: Faster test execution when possible
- **Conditional Live Tests**: Only run expensive live tests when appropriate
- **Test Filtering**: Separate test categories for different scenarios

## ðŸ”§ Customization

### Adding New Test Categories

To add new test categories, update the CI workflow's test steps:

```yaml
- name: Run your new tests
  run: |
    swift test --verbose --filter "YourNewTestClass"
```

### Platform Configuration

To add or modify platform testing, update the `platform-tests` job matrix:

```yaml
strategy:
  matrix:
    platform: [iOS, macOS, tvOS, watchOS, visionOS]
    # Add your platform configuration
```

### Environment Variables

Add environment variables in the workflow `env` section:

```yaml
env:
  SWIFT_VERSION: '6.0'
  YOUR_CUSTOM_VAR: 'value'
```

## ðŸ“ˆ Monitoring and Debugging

### Workflow Status

- **Badge**: Add a workflow status badge to your README
- **Notifications**: GitHub will notify on workflow failures
- **Logs**: Detailed logs available in the Actions tab

### Common Issues

1. **Live API Test Failures**: Usually due to missing `DISCOGS_API_TOKEN` secret
2. **Platform Test Failures**: May indicate Xcode simulator availability issues
3. **Build Failures**: Often related to Swift version or dependency issues

### Debug Tips

- Check individual job logs for specific error messages
- Use `--verbose` flags for more detailed output
- Review the summary reports generated by workflows

## ðŸŽ‰ Benefits

### For Development
- **Early Issue Detection**: Catch problems before they reach production
- **Cross-Platform Confidence**: Ensure compatibility across all platforms
- **Quality Assurance**: Automated code quality and security checks

### For Releases
- **Automated Releases**: Streamlined release process with validation
- **Comprehensive Testing**: Full test suite before any release
- **Documentation**: Automatic documentation generation and validation

### For Collaboration
- **PR Validation**: Every pull request is automatically tested
- **Clear Status**: Visual indicators of build and test status
- **Comprehensive Reports**: Detailed summaries of all checks

## ðŸ“š Additional Resources

- [GitHub Actions Documentation](https://docs.github.com/en/actions)
- [Swift Package Manager Guide](https://swift.org/package-manager/)
- [Discogs API Documentation](https://www.discogs.com/developers/)

---

**Happy coding! ðŸš€**
